(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{365:function(e,t,a){e.exports=a(717)},370:function(e,t,a){},715:function(e,t,a){},717:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(134),m=a.n(r),o=(a(370),a(345)),i=a(346),u=a(360),s=a(347),l=a(361),d=a(56),p=a(46),h=a(16),g=a(14),b=a(45),f=a(348),v=a(199),O=a(349),j=a(91),I=a.n(j),E=(a(706),{apiKey:"AIzaSyCcrzECR6WLk_YtsCk6rUMbNxfFh0cn__8",authDomain:"tydev-ping-pong.firebaseapp.com",databaseURL:"https://tydev-ping-pong.firebaseio.com",projectId:"tydev-ping-pong",storageBucket:"tydev-ping-pong.appspot.com",messagingSenderId:"29869586839",appId:"1:29869586839:web:080ae459d72aa8f6"});I.a.initializeApp(E);var T=I.a.firestore(),_=a(6),y="INITIALIZE_GAME",w="INITIALIZE_MATCH",W="UPDATE_MATCH",S="UPDATE_GAME",N="UPDATE_LOCAL_GAME",k="EXIT_GAME",$="APP_ERROR",G="UPDATE_IDS",C={totalGamesPlayed:0,winner:null};var M=a(44),A={};var x={error:!1,errorMessage:"",matchInit:!1};var F=Object(b.c)({match:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return t.payload.match;case W:return Object(_.a)({},e,{},t.payload);case k:return{};default:return e}},game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:case y:return Object(_.a)({},t.payload.game);case S:return t.payload||e;case N:var a=t.payload,n=a.team,c=a.increment;return Object(_.a)({},e,Object(M.a)({},"".concat(n,"_score"),c?e["".concat(n,"_score")]+1:e["".concat(n,"_score")]-1));case k:return{};default:return e}},app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.error,c=t.payload;switch(a){case w:return Object(_.a)({},e,{matchId:c.matchId,gameId:c.gameId,matchInit:!0});case W:return Object(_.a)({},e,{matchInit:!0});case G:return Object(_.a)({},e,{},c);case $:return Object(_.a)({},e,{error:!0,errorMessage:n});case k:return Object(_.a)({},x,{matchInit:!1});default:return e}}}),L={},D=[f.a.withExtraArgument({getFirebase:O.getFirebase,getFirestore:v.getFirestore})],P=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({trace:!0})||b.d,U=a(4),B=a(23),R=a(355);function z(){var e=Object(B.a)(["\n    mutation DeclareWinner($matchId: String!, $gameId: String!, $winner: TeamEnum!) {\n        declareWinner(matchId: $matchId, gameId: $gameId, winner: $winner) {\n            winner\n            gamesWon {\n                team1\n                team2\n            }\n        }\n    }\n"]);return z=function(){return e},e}function X(){var e=Object(B.a)(["\n    mutation UpdateScore(\n        $matchId: String!\n        $gameId: String!\n        $team: TeamEnum!\n        $increment: Boolean!\n    ) {\n        updateScore(matchId: $matchId, gameId: $gameId, team: $team, increment: $increment) {\n            team1_score\n            team2_score\n            greenTeam\n        }\n    }\n"]);return X=function(){return e},e}var H=Object(g.b)(X()),J=(Object(g.b)(z()),a(7)),K=a(18),Z=function(e){var t=e.side,a=Object(U.b)(),r=Object(U.c)(function(e){return{greenTeam:e.game.greenTeam,matchId:e.app.matchId,gameId:e.app.gameId}}),m=r.greenTeam,o=r.matchId,i=r.gameId,u=Object(K.a)(H,{variables:{matchId:o,gameId:i}}),s=Object(J.a)(u,2),l=s[0],d=s[1].loading,p=Object(n.useState)(!1),h=Object(J.a)(p,2),g=h[0],b=h[1],f=Object(n.useState)(!1),v=Object(J.a)(f,2),O=v[0],j=v[1],I="green"===t?m:"team1"===m?"team2":"team1",E=Object(U.c)(function(e){return{name:e.match["".concat(I,"_name")],score:e.game["".concat(I,"_score")]}}),T=E.name,_=E.score;return Object(n.useEffect)(function(){0!==E.score&&void 0!==E.score&&(j(!0),setTimeout(function(){j(!1)},650))},[E.score]),c.a.createElement("button",{className:"btn--increment "+t+"".concat(O?" scored":""),disabled:d&&g,onClick:function(){b(!0),a({type:N,payload:{team:I,increment:!0}}),l({variables:{team:I,increment:!0}}).then(function(e){b(!1)})}},c.a.createElement("p",{className:"team-name"},T&&T.length>0?T:I),c.a.createElement("p",{className:"score"},_))},q=a(362),V=a(204),Y=a(31),Q=a.n(Y),ee=a(70),te=function(e){var t=e.data,a=e.history;return function(){var e=Object(ee.a)(Q.a.mark(function e(n){return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n({type:w,payload:t}),a.push("/match/".concat(t.matchId,"/game/").concat(t.gameId),Object(_.a)({},t));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},ae=function(e){var t=e.data,a=e.history;return function(){var e=Object(ee.a)(Q.a.mark(function e(n){return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.push("/match/".concat(t.matchId,"/game/").concat(t.gameId),Object(_.a)({},t));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},ne=function(e){var t=e.buttonColor,a=e.dif,n=e.updateScore,c=e.nextGame,r=e.history;return function(){var e=Object(ee.a)(Q.a.mark(function e(m,o){var i,u,s,l,d,p;return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=o(),u=i.game,s=i.app,l=i.match,d="green"===t,p="team1"===u.greenTeam?"team2":"team1",s.matchId&&s.gameId?l.winner||l.matchOver?(m({type:k}),r.push("/match")):u.winner?c().then(function(e){m(ae({data:e.data.nextGame,history:r}))}):(m({type:UPDATE_LOCAL_GAME,payload:{team:d?u.greenTeam:p,score:u["".concat(d?u.greenTeam:p,"_score")],increment:a<=450}}),n({variables:{team:d?u.greenTeam:p,score:u["".concat(d?u.greenTeam:p,"_score")],increment:a<=450,pointToWin:l.pointToWin,matchId:s.matchId,gameId:s.gameId}})):(m({type:k}),r.push("/match"));case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}()};function ce(){var e=Object(B.a)(["\n            mutation NextGame($matchId: String!, $prevGreenTeam: TeamEnum!) {\n                nextGame(matchId: $matchId, prevGreenTeam: $prevGreenTeam) {\n                    matchId\n                    gameId\n                    game {\n                        team1_score\n                        team2_score\n                        servingTeam\n                    }\n                }\n            }\n        "]);return ce=function(){return e},e}function re(e){var t=e.id,a=e.color,n=e.gamepad,c=e.dispatch,r=Object(q.a)(e,["id","color","gamepad","dispatch"]),m={};n.before(t,function(){m=new Date}).after(t,function(){var e=(new Date).getTime()-m.getTime();c(ne(Object(_.a)({buttonColor:a,dif:e},r)))})}function me(){var e=Object(B.a)(["\n    display: grid;\n    position: relative;\n    grid-template-columns: 1fr 50px 1fr;\n"]);return me=function(){return e},e}var oe=R.a.div(me());function ie(){var e=Object(p.f)(),t=Object(U.b)(),a=Object(U.c)(function(e){return Object(_.a)({},e.match,{},e.app,{game:e.game})});a.team1_name,a.team2_name,a.serveNum,a.pointsToWin,a.game,a.matchId,a.gameId;return c.a.createElement(oe,{className:"pi-focused"},c.a.createElement(Z,{side:"green"}),c.a.createElement("div",{className:"center-btns",onClick:function(){t({type:k}),e.push("/match")}}),c.a.createElement(Z,{side:"blue"}))}var ue=a(358),se=a.n(ue);function le(){var e=Object(B.a)(["\n  query getActiveMatch {\n    activeMatch {\n      matchId\n      gameId\n      match {\n        gamesToWin\n        pointsToWin\n        team1_name\n        team2_name\n      }\n      game {\n        team1_score\n        team2_score\n        servingTeam\n      }\n    }\n  }\n"]);return le=function(){return e},e}Object(g.b)(le());function de(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var e=Object(U.b)(),t=Object(n.useState)(!0),a=Object(J.a)(t,2),c=a[0],r=a[1],m=function(){var e=Object(U.b)(),t=Object(n.useState)({}),a=Object(J.a)(t,2),c=a[0],r=a[1],m=Object(n.useState)(!0),o=Object(J.a)(m,2),i=o[0],u=o[1];return Object(n.useEffect)(function(){var t=T.doc("app/activeIds").onSnapshot(function(t){r(t.data()),e({type:G,payload:t.data()}),i&&u(!1)});return function(){t()}},[]),Object(_.a)({},c,{loading:i})}(),o=m.matchId,i=m.gameId,u=m.loading,s=Object(n.useState)({team1_score:0,team2_score:0}),l=Object(J.a)(s,2),d=(l[0],l[1]);return Object(n.useEffect)(function(){if(!u){r(!o||!i);var t=T.doc("matches/".concat(o,"/games/").concat(i)).onSnapshot(function(t){d(t.data()),e({type:S,payload:t.data()})}),a=T.doc("matches/".concat(o)).onSnapshot(function(t){e({type:W,payload:t.data()})});return function(){t(),a()}}},[o,i,u]),{loading:u,isTableOpen:c}}function pe(){var e=Object(B.a)(["\n            mutation NextGame($matchId: String!, $prevGreenTeam: TeamEnum!) {\n                nextGame(matchId: $matchId, prevGreenTeam: $prevGreenTeam) {\n                    matchId\n                    gameId\n                    game {\n                        team1_score\n                        team2_score\n                        servingTeam\n                    }\n                }\n            }\n        "]);return pe=function(){return e},e}function he(){var e=Object(p.f)(),t=Object(U.b)(),a=Object(U.c)(function(e){return e.game.greenTeam}),r=Object(U.c)(function(e){return{team1:{name:e.match.team1_name,score:e.game.team1_score},team2:{name:e.match.team2_name,score:e.game.team2_score},match:e.match,greenTeam:e.game.greenTeam,isMatchOver:null!==e.match.winner,matchWinner:e.match.winner,gameWinner:e.game.winner,app:e.app}}),m=r.app,o=m.matchId,i=(m.gameId,r.match),u=r.isMatchOver,s=r.gameWinner,l=r.matchWinner,d=Object(K.a)(Object(g.b)(pe()),{variables:{matchId:o,prevGreenTeam:a}}),h=Object(J.a)(d,2),b=h[0],f=h[1].loading,v=u?l===a?"green":s===a?"green":"blue":"blue";return Object(n.useEffect)(function(){function a(a){a.key,b().then(function(a){t(ae({data:a.data.nextGame,history:e}))})}return document.addEventListener("keydown",a),function(){document.removeEventListener("keydown",a)}},[t,e,b]),s?c.a.createElement("div",{className:se()("winner-screen pi-focused",v)},c.a.createElement("p",null,u?"".concat(r[l].name," wins the match!"):"".concat(r[s].name," wins the game!")),c.a.createElement("button",{className:"btn--full-width",onClick:function(){u||i.matchOver?(t({type:k}),e.push("/match")):b().then(function(a){t(ae({data:a.data.nextGame,history:e}))})}},u||i.matchOver?"New Match":f?"Loading...":"Next Game")):c.a.createElement(c.a.Fragment,null,c.a.createElement("p",null,"Unknown Error"),c.a.createElement("button",{onClick:function(){return e.push("/match")}},"New Match Screen"))}var ge=function(e){e.history,e.match.params,Object(U.c)(function(e){return e.app.matchInit}),Object(U.c)(function(e){return e.app.matchId});var t=Object(U.c)(function(e){return e.game.winner});!function(){var e=Object(U.b)(),t=Object(p.f)(),a=Object(U.c)(function(e){return{matchId:e.app.matchId,gameId:e.app.gameId,greenTeam:e.game.greenTeam}}),c=a.matchId,r=a.gameId,m=a.greenTeam,o=Object(K.a)(H),i=Object(J.a)(o,2),u=i[0],s=(i[1].loading,Object(K.a)(Object(g.b)(ce()),{variables:{matchId:c,prevGreenTeam:m}})),l=Object(J.a)(s,2),d=l[0];l[1].loading,Object(n.useEffect)(function(){return V.a.on("connect",function(a){var n={gamepad:a,dispatch:e,updateScore:u,nextGame:d,history:t};re(Object(_.a)({id:"button0",color:"green"},n)),re(Object(_.a)({id:"button3",color:"blue"},n))}),function(){V.a.off("connect")}},[c,r])}();var a=de().loading;return t?c.a.createElement(he,null):a?c.a.createElement("p",null,"Loading..."):c.a.createElement(ie,null)},be=a(359),fe=a.n(be);a(714);function ve(){var e=Object(B.a)(["\n        mutation {\n            clearIds\n        }\n    "]);return ve=function(){return e},e}function Oe(){var e=Object(B.a)(["\n        mutation CreateMatch(\n            $pointsToWin: Int\n            $gamesToWin: Int\n            $team1_name: String\n            $team2_name: String\n        ) {\n            createMatch(\n                pointsToWin: $pointsToWin\n                gamesToWin: $gamesToWin\n                team1_name: $team1_name\n                team2_name: $team2_name\n            ) {\n                matchId\n                gameId\n                match {\n                    pointsToWin\n                    gamesToWin\n                    team1_name\n                    team2_name\n                }\n                game {\n                    team1_score\n                    team2_score\n                    servingTeam\n                }\n            }\n        }\n    "]);return Oe=function(){return e},e}var je=function(e){var t=e.history,a=Object(U.b)(),r=Object(n.useState)(!1),m=Object(J.a)(r,2),o=m[0],i=m[1],u=Object(n.useState)(!1),s=Object(J.a)(u,2),l=s[0],d=s[1],p=Object(n.useState)(null),h=Object(J.a)(p,2),b=h[0],f=h[1],v=Object(n.useState)("default"),O=Object(J.a)(v,2),j=O[0],I=O[1],E=Object(n.useState)({team1_name:"",team2_name:"",pointsToWin:21,gamesToWin:3}),T=Object(J.a)(E,2),y=T[0],w=T[1],W=Object(K.a)(Object(g.b)(Oe())),S=Object(J.a)(W,2),N=S[0],k=S[1].loading,$=Object(K.a)(Object(g.b)(ve())),G=Object(J.a)($,2),C=G[0];G[1].data,Object(n.useEffect)(function(){C()},[]);var A=y.team1_name,x=y.team2_name,F=y.gamesToWin,L=y.pointsToWin;function D(e){w(Object(_.a)({},y,Object(M.a)({},e.target.name,"pointsToWin"===e.target.name||"gamesToWin"===e.target.name?parseInt(e.target.value):e.target.value)))}function P(e){d(!0),I("pointsToWin"===e.target.name?"numpad":"default"),w(Object(_.a)({},y,Object(M.a)({},e.target.name,""))),f(e.target.name),i(!0)}return c.a.createElement("div",{style:{display:"grid"},className:"pi-focused"},c.a.createElement("form",{className:"new-match-form",autoComplete:"off",onSubmit:function(){var e=Object(ee.a)(Q.a.mark(function e(n){return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),N({variables:y}).then(function(e){var n=e.data.createMatch;a(te({data:n,history:t}))}).catch(function(e){return console.error(e)});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},c.a.createElement("div",null,c.a.createElement("label",{htmlFor:"team1",onFocus:function(e){return P(e)}},"Green:",c.a.createElement("input",{value:A,name:"team1_name",id:"team1",onChange:function(e){return D(e)}}))),c.a.createElement("div",null,c.a.createElement("label",{htmlFor:"team2",onFocus:function(e){return P(e)}},"Blue:",c.a.createElement("input",{value:x,name:"team2_name",onChange:function(e){return D(e)},id:"team2"}))),c.a.createElement("div",null,c.a.createElement("label",{htmlFor:"game-type"},"Games To Play:",c.a.createElement("select",{name:"gamesToWin",id:"game-type",value:F,onChange:function(e){return D(e)}},c.a.createElement("option",{value:"3"},"3"),c.a.createElement("option",{value:"2"},"2/3"),c.a.createElement("option",{value:"1"},"1")))),c.a.createElement("div",null,c.a.createElement("label",{htmlFor:"pointsToWin",onFocus:function(e){return P(e)},onBlur:function(){}},"Points To Win:",c.a.createElement("input",{type:"number",name:"pointsToWin",value:L,onChange:function(e){return D(e)}}))),c.a.createElement("button",{disabled:l,type:"submit",className:"btn--full-width"},k?"Loading...":"Start Match")),o&&c.a.createElement("div",{className:"keyboard__container ".concat("shift"===j?"keyboard__container--shift":"")},c.a.createElement("div",{className:"keyboard__input"},c.a.createElement("span",null,y[b])),c.a.createElement(fe.a,{onChange:function(e){w(Object(_.a)({},y,Object(M.a)({},b,"pointsToWin"===b||"gamesToWin"===b?parseInt(e):e)))},inputName:b,layoutName:j,layout:{default:["q w e r t y u i o p {bksp}","a s d f g h j k l","z x c v b n m","{shift} & {space} , {close}"],shift:["Q W E R T Y U I O P {bksp}","A S D F G H J K L","Z X C V B N M","{shift} & {space} , {close}"],numpad:["7 8 9","4 5 6","1 2 3","{bksp} 0 {ok}"]},buttonTheme:[{class:"highlight",buttons:"{shift}"}],onKeyPress:function(e){"{shift}"===e&&I("default"===j?"shift":"default"),"{close}"!==e&&"{ok}"!==e||(i(!1),setTimeout(function(){d(!1)},100))},mergeDisplay:!0,display:{"{bksp}":"\u232b","{close}":"\u2713","{shift}":"\u21ea","{ok}":"\u2713"}})))};function Ie(){var e,t,a=de(!1),n=a.loading,r=(a.isOpen,Object(U.c)(function(e){return{team1:{name:e.match.team1_name,score:e.game.team1_score},team2:{name:e.match.team2_name,score:e.game.team2_score},game:e.game,match:e.match,isMatchOver:null!==e.match.winner,matchId:e.app.matchId,gameId:e.app.gameId,matchWinner:e.match.winner,gameWinner:e.game.winner}})),m=r.game,o=r.match,i=r.matchId,u=(r.gameId,r.isMatchOver),s=r.matchWinner,l=r.gameWinner,d=m.greenTeam,p="team1"===m.greenTeam?"team2":"team1",h=(null===(e=o.gamesWon)||void 0===e?void 0:e.team1)+(null===(t=o.gamesWon)||void 0===t?void 0:t.team2);return n?c.a.createElement("p",null,"Loading..."):i?c.a.createElement("div",{className:"scoreboard"},c.a.createElement("div",{className:"games-played",style:{gridColumn:"span 2"}},c.a.createElement("p",null,"Game ",isNaN(h)?0:h," of ",o.gamesToWin)),!m.winner&&c.a.createElement(c.a.Fragment,null,c.a.createElement(Ee,{score:m["".concat(d,"_score")],team:o["".concat(d,"_name")],green:!0}),c.a.createElement(Ee,{score:m["".concat(p,"_score")],team:o["".concat(p,"_name")]})),m.winner&&c.a.createElement("div",{className:"winner-state"},c.a.createElement("p",null,u?"".concat(r[s].name," wins the match!"):"".concat(r[l].name," wins the game!")))):c.a.createElement("div",{className:"scoreboard"},c.a.createElement("p",{className:"open-table"},"Table",c.a.createElement("br",null)," Open"))}function Ee(e){var t=e.score,a=e.team,n=e.green;return c.a.createElement("div",{className:"team-score ".concat(n?"green":"")},c.a.createElement("h1",null,a),c.a.createElement("div",{className:"scoreboard__score"},t))}a(715),a(716);var Te,_e=(Te=I.a,Object(b.e)(F,L,P(b.a.apply(void 0,D),Object(v.reduxFirestore)(Te)))),ye=new g.a,we=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return c.a.createElement(h.a,{client:ye},c.a.createElement(U.a,{store:_e},c.a.createElement(d.a,null,c.a.createElement(p.c,null,c.a.createElement(p.a,{path:["/match","/"],exact:!0,component:je}),c.a.createElement(p.a,{path:["/match/:matchId/game/:gameId"],component:ge}),c.a.createElement(p.a,{path:"/scoreboard",component:Ie}),c.a.createElement(p.a,{path:"/match/winner",component:he})))))}}]),t}(c.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));m.a.render(c.a.createElement(we,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[365,1,2]]]);
//# sourceMappingURL=main.52b0f367.chunk.js.map